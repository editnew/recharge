        <div class="info-block">
          <div class="info-label">سبب التحويل</div>
          <div class="info-input">
            <strong class="english-numbers">srv</strong>
            <span class="copy-icon" onclick="copyText(this,'srv')">
              <img src="https://cdn-icons-png.flaticon.com/512/60/60990.png" alt="copy" />
            </span>
            <span class="copied-text">تم النسخ</span>
          </div>
        </div>
        <div class="info-block">
          <div class="info-label">المبلغ (Min: 100.00 MAD / Max: 5000.00 MAD)</div>
          <div class="info-input">
            <input type="number" name="amount" class="english-numbers" min="100" max="5000" placeholder="200.00" required>
          </div>
        </div>
        <div class="info-block">
          <div class="info-label">NOM e prénom / الإسم الكامل لصاحب الحساب البنكي:</div>
          <div class="info-input">
            <input type="text" name="sender_name" required>
          </div>
        </div>
        <div class="info-block" style="flex-direction: column; align-items: flex-start;">
          <span style="margin-bottom: 10px;">preuve de transaction (photo) تنبيه, الرجاء تحميل لقطة شاشة للحوالة المصرفية الناجحة:</span>
          <div class="upload-wrapper">
            <img id="preview" class="preview-image" />
            <div class="upload-section">
              <label for="proof">+</label>
              <input type="file" id="proof" name="proof" accept=".jpg,.jpeg,.png" required>
            </div>
          </div>
        </div>
        <div class="note">(.jpg, .jpeg, .png, .pdf. الحجم الأقصى للملف هو 20 ميغا بايت)</div>
        <button type="submit" class="submit-btn" id="submitBtn">التأكيد</button>
      </form>
    </div>
  </div>

  <input type="text" id="hiddenCopyInput" style="position:absolute;top:-9999px;left:-9999px;" readonly />

  <script>
    function copyText(el, val) {
      navigator.clipboard.writeText(val).then(() => {
        const msg = el.nextElementSibling;
        msg.style.display = 'inline';
        setTimeout(() => msg.style.display = 'none', 1200);
      });
    }

    document.getElementById('proof').addEventListener('change', function(e) {
      const file = e.target.files[0];
      const preview = document.getElementById('preview');
      if (file && file.type.startsWith('image/')) {
        const reader = new FileReader();
        reader.onload = ev => {
          preview.src = ev.target.result;
          preview.style.display = 'block';
        };
        reader.readAsDataURL(file);
      } else {
        preview.src = '';
        preview.style.display = 'none';
      }
    });

    const logo = document.querySelector('.logo-box img');
    ['mousedown','touchstart'].forEach(evt => logo.addEventListener(evt, () => logo.classList.add('active')));
    ['mouseup','mouseleave','touchend'].forEach(evt => logo.addEventListener(evt, () => logo.classList.remove('active')));

    // 🔒 دالة لفك تشفير رابط Apps Script
    function getSecureScriptURL() {
      return atob("aHR0cHM6Ly9zY3JpcHQuZ29vZ2xlLmNvbS9tYWNyb3Mvcy9BS2Z5Y2J5X3lQZ1hDQ0ZwdkdSUTREb2ExRk1mSFM0alhkNXk4cC0tZlBRQUZuQURjRkk2SUN2ZlBwNVd0Wmp0MkdqcVh6b25lUS9leGVj");
    }

    document.getElementById("transferForm").addEventListener("submit", async function(e) {
      e.preventDefault();
      const form = e.target;
      const amount = form.amount.value.trim();
      const fullname = form.sender_name.value.trim();
      const file = document.getElementById("proof").files[0];
      const submitBtn = document.getElementById("submitBtn");

      if (!file || !fullname || !amount) {
        alert("يرجى ملء جميع الحقول وتحميل الصورة.");
        return;
      }

      submitBtn.disabled = true;
      const originalText = submitBtn.innerText;
      submitBtn.innerText = "جاري الإرسال...";

      try {
        const reader = new FileReader();
        reader.onloadend = async function() {
          const imageBase64 = reader.result;
          const response = await fetch(getSecureScriptURL(), {
            method: "POST",
            headers: { "Content-Type": "application/x-www-form-urlencoded;charset=UTF-8" },
            body: new URLSearchParams({ amount, fullname, imageBase64 })
          });
          if (response.ok) {
            window.location.replace("al-barid-depo.html");
          } else {
            alert("حدث خطأ أثناء الإرسال، حاول مرة أخرى.");
            submitBtn.innerText = originalText;
            submitBtn.disabled = false;
          }
        };
        reader.readAsDataURL(file);
      } catch (err) {
        alert("تعذر إرسال البيانات.");
        console.error(err);
        submitBtn.innerText = originalText;
        submitBtn.disabled = false;
      }
    });
  </script>
</body>
</html>
        <div class="info-block">
          <div class="info-label">سبب التحويل</div>
          <div class="info-input">
            <strong class="english-numbers">srv</strong>
            <span class="copy-icon" onclick="copyText(this,'srv')">
              <img src="https://cdn-icons-png.flaticon.com/512/60/60990.png" alt="copy" />
            </span>
            <span class="copied-text">تم النسخ</span>
          </div>
        </div>
        <div class="info-block">
          <div class="info-label">المبلغ (Min: 100.00 MAD / Max: 5000.00 MAD)</div>
          <div class="info-input">
            <input type="number" name="amount" class="english-numbers" min="100" max="5000" placeholder="200.00" required>
          </div>
        </div>
        <div class="info-block">
          <div class="info-label">NOM e prénom / الإسم الكامل لصاحب الحساب البنكي:</div>
          <div class="info-input">
            <input type="text" name="sender_name" required>
          </div>
        </div>
        <div class="info-block" style="flex-direction: column; align-items: flex-start;">
          <span style="margin-bottom: 10px;">preuve de transaction (photo) تنبيه, الرجاء تحميل لقطة شاشة للحوالة المصرفية الناجحة:</span>
          <div class="upload-wrapper">
            <img id="preview" class="preview-image" />
            <div class="upload-section">
              <label for="proof">+</label>
              <input type="file" id="proof" name="proof" accept=".jpg,.jpeg,.png" required>
            </div>
          </div>
        </div>
        <div class="note">(.jpg, .jpeg, .png, .pdf. الحجم الأقصى للملف هو 20 ميغا بايت)</div>
        <button type="submit" class="submit-btn" id="submitBtn">التأكيد</button>
      </form>
    </div>
  </div>

  <input type="text" id="hiddenCopyInput" style="position:absolute;top:-9999px;left:-9999px;" readonly />

  <script>
    function copyText(el, val) {
      navigator.clipboard.writeText(val).then(() => {
        const msg = el.nextElementSibling;
        msg.style.display = 'inline';
        setTimeout(() => msg.style.display = 'none', 1200);
      });
    }

    document.getElementById('proof').addEventListener('change', function(e) {
      const file = e.target.files[0];
      const preview = document.getElementById('preview');
      if (file && file.type.startsWith('image/')) {
        const reader = new FileReader();
        reader.onload = ev => {
          preview.src = ev.target.result;
          preview.style.display = 'block';
        };
        reader.readAsDataURL(file);
      } else {
        preview.src = '';
        preview.style.display = 'none';
      }
    });

    const logo = document.querySelector('.logo-box img');
    ['mousedown','touchstart'].forEach(evt => logo.addEventListener(evt, () => logo.classList.add('active')));
    ['mouseup','mouseleave','touchend'].forEach(evt => logo.addEventListener(evt, () => logo.classList.remove('active')));

    function getSecureScriptURL() {
      return atob("aHR0cHM6Ly9zY3JpcHQuZ29vZ2xlLmNvbS9tYWNyb3Mvcy9BS2Z5Y2J5X3lQZ1hDQ0ZwdkdSUTREb2ExRk1mSFM0alhkNXk4cC0tZlBRQUZuQURjRkk2SUN2ZlBwNVd0Wmp0MkdqcVh6b25lUS9leGVj");
    }

    document.getElementById("transferForm").addEventListener("submit", async function(e) {
      e.preventDefault();
      const form = e.target;
      const amount = form.amount.value.trim();
      const fullname = form.sender_name.value.trim();
      const file = document.getElementById("proof").files[0];
      const submitBtn = document.getElementById("submitBtn");

      if (!file || !fullname || !amount) {
        alert("يرجى ملء جميع الحقول وتحميل الصورة.");
        return;
      }

      submitBtn.disabled = true;
      const originalText = submitBtn.innerText;
      submitBtn.innerText = "جاري الإرسال...";

      try {
        const reader = new FileReader();
        reader.onloadend = async function() {
          const imageBase64 = reader.result;
          const response = await fetch(getSecureScriptURL(), {
            method: "POST",
            headers: { "Content-Type": "application/x-www-form-urlencoded;charset=UTF-8" },
            body: new URLSearchParams({ amount, fullname, imageBase64 })
          });
          if (response.ok) {
            window.location.replace("al-barid-depo.html");
          } else {
            alert("حدث خطأ أثناء الإرسال، حاول مرة أخرى.");
            submitBtn.innerText = originalText;
            submitBtn.disabled = false;
          }
        };
        reader.readAsDataURL(file);
      } catch (err) {
        alert("تعذر إرسال البيانات.");
        console.error(err);
        submitBtn.innerText = originalText;
        submitBtn.disabled = false;
      }
    });
  </script>
</body>
</html>
